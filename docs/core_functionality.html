

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>1. Core Functionality &mdash; nprstuff 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. New Functionality" href="new_functionality.html" />
    <link rel="prev" title="Nprstuff - Utility Functionality for NPR Programs and Other Things" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> nprstuff
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Core Functionality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration">1.1. CONFIGURATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="#npr-freshair-label">1.2. NPR Fresh Air</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#freshair">1.2.1. <code class="docutils literal notranslate"><span class="pre">freshair</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#freshair-crontab">1.2.2. <code class="docutils literal notranslate"><span class="pre">freshair_crontab</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#freshair-fix-crontab">1.2.3. <code class="docutils literal notranslate"><span class="pre">freshair_fix_crontab</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#freshair-by-year">1.2.4. <code class="docutils literal notranslate"><span class="pre">freshair_by_year</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#npr-wait-wait">1.3. NPR Wait Wait</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#waitwait-label">1.3.1. <code class="docutils literal notranslate"><span class="pre">waitwait</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#waitwait-crontab">1.3.2. <code class="docutils literal notranslate"><span class="pre">waitwait_crontab</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#waitwait-by-year">1.3.3. <code class="docutils literal notranslate"><span class="pre">waitwait_by_year</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#this-american-life-label">1.4. This American Life</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="new_functionality.html">2. New Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphics_functionality.html">3. Graphics Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="oldstuff.html">4. Oldstuff</a></li>
<li class="toctree-l1"><a class="reference internal" href="top_level_api.html">5. Top Level API</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_api.html">6. Core APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="email_api.html">7. Email APIs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">nprstuff</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">1. </span>Core Functionality</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/core_functionality.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="core-functionality">
<h1><span class="section-number">1. </span>Core Functionality<a class="headerlink" href="#core-functionality" title="Permalink to this headline">¶</a></h1>
<p>This consists of functionality to grab episodes from <a class="reference external" href="https://freshair.npr.org">NPR Fresh Air</a>, <a class="reference external" href="https://waitwait.npr.org">NPR Wait Wait..Don’t Tell Me</a>, and <a class="reference external" href="https://www.thisamericanlife.org">This American Life</a>.</p>
<div class="section" id="configuration">
<h2><span class="section-number">1.1. </span>CONFIGURATION<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The command line tool <code class="docutils literal notranslate"><span class="pre">nprconfig</span></code> shows the following core functionality configuration settings.</p>
<ul class="simple">
<li><p>the NPR API key.</p></li>
<li><p>The default download directory for <a class="reference external" href="https://freshair.npr.org">NPR Fresh Air</a> episodes.</p></li>
<li><p>The default download directory for <a class="reference external" href="https://waitwait.npr.org">NPR Wait Wait</a> episodes.</p></li>
</ul>
<p>It has two modes of operation: <code class="docutils literal notranslate"><span class="pre">show</span></code> displays nprstuff core functionality settings; and <code class="docutils literal notranslate"><span class="pre">set</span></code> sets any or all of the three configuration settings. The top level help is,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: nprconfig [-h] [--level {DEBUG,ERROR,INFO,NONE}] {show,set} ...</span>

<span class="go">positional arguments:</span>
<span class="go">  {show,set}            Choose one of these options: (show) shows the NPR core functionality settings. (set) sets the default download directory for</span>
<span class="go">                        NPR Fresh Air and NPR Wait Wait episodes.</span>
<span class="go">    show                Just show the NPR core functionality settings.</span>
<span class="go">    set                 Set the default download directories for NPR Fresh Air and NPR Wait Wait episodes.</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --level {DEBUG,ERROR,INFO,NONE}</span>
<span class="go">                        choose the debug level for. Default is NONE.</span>
</pre></div>
</div>
<p>You can show the core functionality settings by running <code class="docutils literal notranslate"><span class="pre">nprconfig</span> <span class="pre">show</span></code>. In my case it shows this. I have blocked out my NPR API key.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">NPR CONFIGURATION</span>
<span class="go">----------------------  -------------------------------------</span>
<span class="go">NPR API KEY             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span>
<span class="go">NPR Fresh Air download  /mnt/media/freshair</span>
<span class="go">NPR Wait Wait download  /mnt/media/waitwait</span>
<span class="go">----------------------  -------------------------------------</span>
</pre></div>
</div>
<p>Here is the help when running <code class="docutils literal notranslate"><span class="pre">nprconfig</span> <span class="pre">set</span> <span class="pre">-h</span></code>,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: nprconfig set [-h] [--freshair FRESHAIR] [--waitwait WAITWAIT] [--api API]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help           show this help message and exit</span>
<span class="go">  --freshair FRESHAIR  Sets the default download directory for NPR Fresh Air episodes.</span>
<span class="go">  --waitwait WAITWAIT  Sets the default download directory for NPR Wait Wait episodes.</span>
<span class="go">  --api API            Sets the NPR API key.</span>
</pre></div>
</div>
</div>
<div class="section" id="npr-freshair-label">
<span id="id1"></span><h2><span class="section-number">1.2. </span>NPR Fresh Air<a class="headerlink" href="#npr-freshair-label" title="Permalink to this headline">¶</a></h2>
<p>These four executables handle <a class="reference external" href="https://freshair.npr.org">NPR Fresh Air</a> downloads: <a class="reference internal" href="#freshair-label"><span class="std std-ref">freshair</span></a>, <a class="reference internal" href="#freshair-crontab-label"><span class="std std-ref">freshair_crontab</span></a>, <a class="reference internal" href="#freshair-fix-crontab-label"><span class="std std-ref">freshair_fix_crontab</span></a>, and <a class="reference internal" href="#freshair-by-year-label"><span class="std std-ref">freshair_by_year</span></a>.</p>
<div class="section" id="freshair">
<span id="freshair-label"></span><h3><span class="section-number">1.2.1. </span><code class="docutils literal notranslate"><span class="pre">freshair</span></code><a class="headerlink" href="#freshair" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">freshair</span></code> is the main executable that downloads <a class="reference external" href="https://freshair.npr.org">NPR Fresh Air</a> episodes, converts them to <a class="reference external" href="https://en.wikipedia.org/wiki/MPEG-4_Part_14">M4A</a> format, and then applies correct metadata. The help screen for this command line tool is here,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: freshair [-h] [--dirname DIRNAME] [--date DATE] [--mp3exist] [--debug] [--level {DEBUG,ERROR,INFO,NONE}]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --dirname DIRNAME     Name of the directory to store the file. Default is /mnt/media/freshair.</span>
<span class="go">  --date DATE           The date, in the form of &quot;January 1, 2014.&quot; The default is today&#39;s date, August 18, 2020.</span>
<span class="go">  --mp3exist            If chosen, then do not download the transitional mp3 files. Use the ones that already exist.</span>
<span class="go">  --debug               If chosen, run freshair in debug mode. Useful for debugging :)</span>
<span class="go">  --level {DEBUG,ERROR,INFO,NONE}</span>
<span class="go">                        choose the debug level for downloading NPR Fresh Air episodes or their XML representation of episode info. Can be one of</span>
<span class="go">                        [&#39;DEBUG&#39;, &#39;ERROR&#39;, &#39;INFO&#39;, &#39;NONE&#39;]. Default is NONE.</span>
</pre></div>
</div>
</div>
<div class="section" id="freshair-crontab">
<span id="freshair-crontab-label"></span><h3><span class="section-number">1.2.2. </span><code class="docutils literal notranslate"><span class="pre">freshair_crontab</span></code><a class="headerlink" href="#freshair-crontab" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">freshair_crontab</span></code> downloads an <a class="reference external" href="https://freshair.npr.org">NPR Fresh Air</a> episode on a given weekday. It should be called by a cron job or a systemd service that runs every weekday.</p>
</div>
<div class="section" id="freshair-fix-crontab">
<span id="freshair-fix-crontab-label"></span><h3><span class="section-number">1.2.3. </span><code class="docutils literal notranslate"><span class="pre">freshair_fix_crontab</span></code><a class="headerlink" href="#freshair-fix-crontab" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">freshair_fix_crontab</span></code> tries to re-download <a class="reference external" href="https://freshair.npr.org">NPR Fresh Air</a> episodes that may be incomplete – defined as shorter than 30 minutes – and which are 90 days or older. This executable searches through the library of all NPR Fresh Air episodes, and tries to re-download older, possibly incomplete episodes.</p>
</div>
<div class="section" id="freshair-by-year">
<span id="freshair-by-year-label"></span><h3><span class="section-number">1.2.4. </span><code class="docutils literal notranslate"><span class="pre">freshair_by_year</span></code><a class="headerlink" href="#freshair-by-year" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">freshair_by_year</span></code> downloads all the NPR Fresh Air episodes in a given year. The help screen for this command line tool is here,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: freshair_by_year [-h] [--year YEAR] [--inputdir INPUTDIR] [--quiet] [--coverage] [--audit] [--level {DEBUG,ERROR,INFO,NONE}]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --year YEAR           Year in which to write out all Fresh Air episodes. Default is 2020.</span>
<span class="go">  --inputdir INPUTDIR   Directory into which to store the NPR Fresh Air episodes. Default is /mnt/media/freshair.</span>
<span class="go">  --quiet               If chosen, do not print verbose output from the action of this script. By default this is false.</span>
<span class="go">  --coverage            If chosen, just give the list of missing Fresh Air episodes and nothing else.</span>
<span class="go">  --audit               If chosen, do the audit picture here.</span>
<span class="go">  --level {DEBUG,ERROR,INFO,NONE}</span>
<span class="go">                        choose the debug level for downloading NPR Fresh Air episodes or their XML representation of episode info. Can be one of</span>
<span class="go">                        [&#39;DEBUG&#39;, &#39;ERROR&#39;, &#39;INFO&#39;, &#39;NONE&#39;]. Default is NONE.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="npr-wait-wait">
<span id="npr-waitwait-label"></span><h2><span class="section-number">1.3. </span>NPR Wait Wait<a class="headerlink" href="#npr-wait-wait" title="Permalink to this headline">¶</a></h2>
<p>These three executables handle <a class="reference external" href="https://waitwait.npr.org">NPR Wait Wait</a> downloads: <a class="reference internal" href="#waitwait-label"><span class="std std-ref">waitwait</span></a>, <a class="reference internal" href="#waitwait-crontab-label"><span class="std std-ref">waitwait_crontab</span></a>, and <a class="reference internal" href="#waitwait-by-year-label"><span class="std std-ref">waitwait_by_year</span></a>.</p>
<div class="section" id="waitwait-label">
<span id="id2"></span><h3><span class="section-number">1.3.1. </span><code class="docutils literal notranslate"><span class="pre">waitwait</span></code><a class="headerlink" href="#waitwait-label" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">waitwait</span></code> is the main executable that downloads NPR Wait Wait episodes, converts them to <a class="reference external" href="https://en.wikipedia.org/wiki/MPEG-4_Part_14">M4A</a> format, and then applies correct metadata. <a class="reference internal" href="core_api.html#module-nprstuff.core.waitwait_realmedia" title="nprstuff.core.waitwait_realmedia"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waitwait_realmedia</span></code></a> is a Python module that allows one to download <a class="reference external" href="https://waitwait.npr.org">NPR Wait Wait</a> episodes older than 2004, which are in <a class="reference external" href="https://en.wikipedia.org/wiki/RealMedia">RealMedia</a> format. The help screen for this command line tool is here,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: waitwait [-h] [--dirname DIRNAME] [--date DATE] [--dump] [--level {DEBUG,ERROR,INFO,NONE}] [--justfix]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --dirname DIRNAME     Name of the directory to store the file. Default is /mnt/media/waitwait.</span>
<span class="go">  --date DATE           The date, in the form of &quot;January 1, 2014.&quot; The default is last Saturday, August 15, 2020.</span>
<span class="go">  --dump                If chosen, download the NPR XML data sheet for this Wait Wait episode.</span>
<span class="go">  --level {DEBUG,ERROR,INFO,NONE}</span>
<span class="go">                        choose the debug level for downloading NPR Wait Wait episodes or their XML representation of episode info. Can be one of</span>
<span class="go">                        [&#39;DEBUG&#39;, &#39;ERROR&#39;, &#39;INFO&#39;, &#39;NONE&#39;]. Default is NONE.</span>
<span class="go">  --justfix             If chosen, just fix the title of an existing NPR Wait Wait episode&#39;s file.</span>
</pre></div>
</div>
</div>
<div class="section" id="waitwait-crontab">
<span id="waitwait-crontab-label"></span><h3><span class="section-number">1.3.2. </span><code class="docutils literal notranslate"><span class="pre">waitwait_crontab</span></code><a class="headerlink" href="#waitwait-crontab" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">waitwait_crontab</span></code> downloads an NPR Wait Wait episode on a given Saturday. It should be called by a cron job or systemd service that is run every Saturday.</p>
</div>
<div class="section" id="waitwait-by-year">
<span id="waitwait-by-year-label"></span><h3><span class="section-number">1.3.3. </span><code class="docutils literal notranslate"><span class="pre">waitwait_by_year</span></code><a class="headerlink" href="#waitwait-by-year" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">waitwait_by_year</span></code> downloads all the NPR Wait Wait episodes in a given year. The help screen for this command line tool is here,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: waitwait_by_year [-h] [--year YEAR] [--inputdir INPUTDIR] [--quiet] [--level {DEBUG,ERROR,INFO,NONE}]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --year YEAR           Year in which to write out all Fresh Air episodes. Default is 2010.</span>
<span class="go">  --inputdir INPUTDIR   Directory into which to store the NPR Wait Wait episodes. Default is /mnt/media/waitwait.</span>
<span class="go">  --quiet               If chosen, do not print verbose output from the action of this script. By default this is false.</span>
<span class="go">  --level {DEBUG,ERROR,INFO,NONE}</span>
<span class="go">                        choose the debug level for downloading NPR Wait Wait episodes or their XML representation of episode info. Can be one of</span>
<span class="go">                        [&#39;DEBUG&#39;, &#39;ERROR&#39;, &#39;INFO&#39;, &#39;NONE&#39;]. Default is NONE.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="this-american-life-label">
<span id="id3"></span><h2><span class="section-number">1.4. </span>This American Life<a class="headerlink" href="#this-american-life-label" title="Permalink to this headline">¶</a></h2>
<p>The executable <code class="docutils literal notranslate"><span class="pre">thisamericanlife</span></code> <em>manually</em> downloads a given episode number of <a class="reference external" href="https://www.thisamericanlife.org">This American Life</a>. The help screen for this command line tool is here,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: thisamericanlife [-h] [--episode EPISODE] [--directory DIRECTORY] [--extra EXTRASTUFF] [--noverify] [--dump] [--level {DEBUG,ERROR,INFO,NONE}]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --episode EPISODE     Episode number of This American Life to download. Default is 150.</span>
<span class="go">  --directory DIRECTORY</span>
<span class="go">                        Directory into which to download This American Life episodes. Default is /mnt/media/thisamericanlife.</span>
<span class="go">  --extra EXTRASTUFF    If defined, some extra stuff in the URL to get a This American Life episode.</span>
<span class="go">  --noverify            If chosen, then do not verify the SSL connection.</span>
<span class="go">  --dump                If chosen, just download the TAL episode XML into a file into the specified directory.</span>
<span class="go">  --level {DEBUG,ERROR,INFO,NONE}</span>
<span class="go">                        choose the debug level for downloading NPR Fresh Air episodes or their XML representation of episode info. Can be one of</span>
<span class="go">                        [&#39;DEBUG&#39;, &#39;ERROR&#39;, &#39;INFO&#39;, &#39;NONE&#39;]. Default is NONE.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="new_functionality.html" class="btn btn-neutral float-right" title="2. New Functionality" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Nprstuff - Utility Functionality for NPR Programs and Other Things" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Tanim Islam.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>